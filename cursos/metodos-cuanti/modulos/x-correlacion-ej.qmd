---
title: "Correlaci√≥n Bivariada de Pearson"
description: "Clase: concepto, visualizaci√≥n con slider, f√≥rmula, ejemplo e interpretaciones."
format:
  html:
    toc: true
    toc-location: left
    code-fold: false
execute:
  echo: false
---

# 1. ¬øQu√© es una correlaci√≥n?
  
  La **correlaci√≥n** mide el grado de asociaci√≥n lineal entre dos variables num√©ricas.  
Su valor est√° acotado entre **-1 y 1**:
  
  - **+1** ‚Üí correlaci√≥n positiva perfecta: cuando una variable aumenta, la otra tambi√©n lo hace de forma proporcional.
- **-1** ‚Üí correlaci√≥n negativa perfecta: cuando una variable aumenta, la otra disminuye de forma proporcional.
- **0** ‚Üí ausencia de correlaci√≥n lineal.

> üí° Importante: la correlaci√≥n **no implica causalidad**.

**Ejemplo conceptual**:  
  - Altura y peso de las personas: suele haber correlaci√≥n positiva (personas m√°s altas tienden a pesar m√°s).  
- Horas de estudio y cantidad de errores en un examen: podr√≠a haber correlaci√≥n negativa (m√°s estudio, menos errores).


  
# 2. Visualizaci√≥n interactiva
  
  Podemos ver c√≥mo cambia el patr√≥n de puntos y la recta estimada a medida que la correlaci√≥n var√≠a.

```{ojs}
//| echo: false
//| output: true

// Importes

// Slider de correlaci√≥n (como en tu ejemplo)
viewof rho = Inputs.range([-1, 1], {
  value: 0,
  step: 0.01,
  label: "Correlaci√≥n (œÅ)"
})

// RNG normal est√°ndar (Box‚ÄìMuller)
function randn() {
  let u = 0, v = 0;
  while (u === 0) u = Math.random();
  while (v === 0) v = Math.random();
  return Math.sqrt(-2 * Math.log(u)) * Math.cos(2 * Math.PI * v);
}

```


```{ojs}

// Datos y estad√≠sticos (reactivos a 'rho')
n = 400

data = {
  const x1 = Array.from({length: n}, randn);
  const x2 = Array.from({length: n}, randn);
  // Construimos Y con correlaci√≥n aprox. 'rho' respecto de X
  return x1.map((z1, i) => {
    const z2 = x2[i];
    const x = z1;
    const y = rho * z1 + Math.sqrt(Math.max(0, 1 - rho**2)) * z2;
    return {x, y};
  });
}

// utilidades
function mean(arr, f){ let s=0; for (const d of arr) s += f(d); return s/arr.length; }
function sum(arr, f){ let s=0; for (const d of arr) s += f(d); return s; }

// estad√≠sticos para la recta y r
meanX = mean(data, d => d.x)
meanY = mean(data, d => d.y)
Sxx = sum(data, d => (d.x - meanX)**2)
Syy = sum(data, d => (d.y - meanY)**2)
Sxy = sum(data, d => (d.x - meanX)*(d.y - meanY))
slope = Sxy / Sxx
intercept = meanY - slope * meanX
r_sample = Sxy / Math.sqrt(Sxx * Syy)

// dominio y puntos de la recta
xMin = -3.5
xMax =  3.5
fitline = [{x: xMin, y: intercept + slope*xMin}, {x: xMax, y: intercept + slope*xMax}]


```



```{ojs}

// Gr√°fico (la √∫ltima expresi√≥n devuelve el SVG)
Plot.plot({
  width: 720,
  height: 440,
  marks: [
    Plot.dot(data, {x: "x", y: "y", r: 2, fillOpacity: 0.7}),
    Plot.ruleX([0], {stroke: "gray", strokeOpacity: 0.5}),
    Plot.ruleY([0], {stroke: "gray", strokeOpacity: 0.5}),
    Plot.line(fitline, {x: "x", y: "y"})
  ],
  x: {label: "X (estandarizada)", domain: [xMin, xMax]},
  y: {label: "Y (estandarizada)", domain: [xMin, xMax]}
})

```




# 3. F√≥rmula formal de la correlaci√≥n de Pearson

La correlaci√≥n muestral de Pearson entre $X$ e $Y$ es:

$$
r_{xy} = \frac{\sum_{i=1}^{n} (x_i - \bar{x}) (y_i - \bar{y})}
{\sqrt{\sum_{i=1}^{n} (x_i - \bar{x})^2} \ \sqrt{\sum_{i=1}^{n} (y_i - \bar{y})^2}}
$$

**Elementos:**
- $x_i, y_i$: valores observados de las variables $X$ e $Y$.  
- $\bar{x}, \bar{y}$: medias muestrales de $X$ e $Y$.  
- $n$: n√∫mero de observaciones.  
- El **numerador** es la suma de productos centrados (proporcional a la **covarianza** muestral).  
- El **denominador** normaliza por la dispersi√≥n de cada variable (sus desviaciones est√°ndar muestrales), acotando $r$ a $[-1, 1]$.

---

# 4. Ejemplo num√©rico completo

Supongamos los siguientes datos:

| Persona | Horas de estudio (X) | Nota en el examen (Y) |
|:------:|:---------------------:|:---------------------:|
|   1    |          2            |          65           |
|   2    |          4            |          70           |
|   3    |          6            |          78           |
|   4    |          8            |          85           |
|   5    |         10            |          95           |

C√°lculos paso a paso:

1. Medias:
   $\bar{x} = 6, \qquad \bar{y} = 78.6$

2. Sumas centradas:
   $$
   S_{xx}=\sum (x_i-\bar{x})^2 = 40.0, \quad
   S_{yy}=\sum (y_i-\bar{y})^2 = 569.2, \quad
   S_{xy}=\sum (x_i-\bar{x})(y_i-\bar{y}) = 150.0
   $$

3. Denominador:
   $$
   \sqrt{S_{xx}}\cdot\sqrt{S_{yy}} \approx 6.3249 \times 23.8440 \approx 150.8907
   $$

4. Correlaci√≥n:
   $$
   r \;=\; \frac{S_{xy}}{\sqrt{S_{xx}}\sqrt{S_{yy}}}
     \;=\; \frac{150.0}{150.8907}
     \;\approx\; 0.9941
   $$

**Interpretaci√≥n:** relaci√≥n **positiva y muy fuerte** entre horas de estudio y nota en este ejemplo.

---

# 5. Interpretando correlaciones (callouts plegables)

Afirmaciones frecuentes y su traducci√≥n a lenguaje matem√°tico/interpretativo:

::: {.callout-tip collapse="true" title="‚ÄúAltura y peso tienen una correlaci√≥n de 0.80.‚Äù"}
- **Tipo:** proporcional (correlaci√≥n **positiva**).  
- **Fuerza:** **fuerte** (‚âà 0.8).  
- **Significado:** a mayor altura, mayor peso, y la relaci√≥n lineal es consistente (pero no perfecta).  
- **Cuidado:** no implica que la altura ‚Äúcause‚Äù el peso; describe asociaci√≥n lineal.
:::

::: {.callout-warning collapse="true" title="‚ÄúHoras de estudio y errores tienen una correlaci√≥n de -0.65.‚Äù"}
- **Tipo:** inversamente proporcional (correlaci√≥n **negativa**).  
- **Fuerza:** **moderada** (‚âà -0.65).  
- **Significado:** m√°s horas de estudio suelen asociarse con **menos** errores.  
- **Cuidado:** hay variabilidad; no todos los casos siguen exactamente ese patr√≥n.
:::

::: {.callout-note collapse="true" title="‚ÄúConsumo de caf√© y productividad tienen una correlaci√≥n de 0.30.‚Äù"}
- **Tipo:** proporcional (positiva).  
- **Fuerza:** **d√©bil a moderada** (‚âà 0.3).  
- **Significado:** tendencia leve a que, cuanto m√°s caf√©, mayor productividad **en promedio**.  
- **Cuidado:** la relaci√≥n es d√©bil; podr√≠a no ser estable entre grupos/escenarios.
:::

::: {.callout-important collapse="true" title="‚ÄúLa correlaci√≥n entre dos variables es -0.05.‚Äù"}
- **Tipo:** pr√°cticamente **nula** (muy cerca de 0).  
- **Fuerza:** **inexistente** a **muy d√©bil**.  
- **Significado:** no hay evidencia de relaci√≥n lineal clara.  
- **Cuidado:** podr√≠a existir **relaci√≥n no lineal** que el coeficiente de Pearson no capta.
:::

---

## Ap√©ndice: buenas pr√°cticas al usar correlaci√≥n

- Use correlaci√≥n de Pearson con **variables cuantitativas** y relaci√≥n **aprox. lineal**.  
- Revise **outliers** y **no linealidades**; pueden distorsionar \(r\).  
- Para relaciones mon√≥tonas no lineales, considere **Spearman**.  
- Recuerde: correlaci√≥n **no** es causalidad; complemente con teor√≠a/dise√±o de investigaci√≥n.

---
